<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="tribuna.content">

<body>

<metal:block fill-slot="style_slot">
  <link rel="stylesheet" type="text/css"
        tal:define="navroot context/@@plone_portal_state/navigation_root_url"
        tal:attributes="href string:${navroot}/++resource++tribuna.diazotheme/css/jquery-ui-1.10.3.custom.min.css"/>
  <script type="text/javascript"
          tal:define="navroot context/@@plone_portal_state/navigation_root_url"
          tal:attributes="src string:${navroot}/++resource++tribuna.diazotheme/js/jquery-ui-1.10.3.custom.min.js">
  </script>
</metal:block>

<metal:main fill-slot="main">
<tal:main-macro metal:define-macro="main">

  <div tal:replace="structure provider:plone.abovecontenttitle" />
  <h1 class="documentFirstHeading">Home page</h1>
  <div tal:replace="structure provider:plone.belowcontenttitle" />
  <div tal:replace="structure provider:plone.abovecontentbody" />

  <div id="search-form">
      <form id="searchForm" name="searchForm" method="post" action="@@search">
        <div class="LSBox">
          <input type="text" id="searchGadget" class="searchField"
                 placeholder="Search ..." title="Search" name="SearchableText"
                 autocomplete="off" i18n:attributes="placeholder">
          <div class="LSResult bordered" id="LSResult" style="display:none;">
            <div class="LSShadow" id="LSShadow"></div>
          </div>
        </div>
        <div id="search-controls" class="formControls">
          <input id="search-button" name="search-button" class="submit-widget button-field" value="Search" type="submit" />
        </div>
      </form>
  </div>

  <tal:block tal:define="has_one_tag view/only_one_tag;
                         hasOneTagClassAddition python: has_one_tag and '-one' or '';
                         articles view/_get_articles">

    <tal:block tal:condition="has_one_tag">
      <tal:block tal:define="text_image view/tag_text_and_image">
        <div id="tag-picture">
          <img tal:condition="text_image/image" src="${text_image/image}"
               alt="Tag image"/>
          <div tal:condition="text_image/image" id="scroll"/>
        </div>
        <div id="tag-description-div">
          <p class="tag-description-text"
             tal:condition="text_image/text"
             tal:content="structure text_image/text"></p>
          <div class="tag-description-text"
             tal:condition="not: text_image/text">
            <h2>Kočijaž in njegov pes</h2>
            <p>Nekoč je v koči živel kočijaž.<br />
            Imel je psa, ki mu je vsak dan prinesel časopis.<br />
            Rekel je: “Pes, ti si pa res fajn.” In pes je pomahal z repom.<br />
            Nekega dne pa je pes dejal: “Hov, hov, hov.” In kočijaž je bil žalosten.<br />
            Zapregel je konje v svojo kočijo in šel na izlet po okoliških krajih, kjer je bilo lepo, kar ga je spravilo v dobro voljo.<br />
            Ko je prišel nazaj, je psu prinesel časopis, napravil mu je limonado in ga pobožal po glavi.<br />
            Pes je bil vesel, zato je naslednji dan prinesel dva časopisa.<br />
            Vendar pa je kočijaž potreboval le enega, zato je rekel hvala.</p>

            <p>Nauk zgodbe: koncepta oznake še ni.</p>
           </div>
        </div>
      </tal:block>
    </tal:block>

    <div id="homepage-div"
         tal:define="articles_num python: len(articles['all'])">
      <div id="empty-results"
          tal:condition="python: not articles['all'] or articles_num == 0">

          <h2>Pravljica o pravljici</h2>
          <p>Nekoč je živela pravljica, ki se ni začela z “Nekoč je …”<br />
          Vse ostale pravljice so se začele z nekoč je, ta pa se ni, zato je bila prav posebna pravljica.<br />
          Ostalim pravljicam se je zdela čudna in zato so se do nje obnašale čudno in niso želele sloneti na polici skupaj z njo.<br />
          Tako je imela v knjižnici polico samo zase.<br />
          Vsi otroci, ki so prišli v knjižnico so jo takoj opazili, saj je bila na polici sama in ni bila skrita med množico drugih. Vzeli so jo domov in ugotovili, da se ne začne z nekoč je, kot vse ostale dolgočasne pravljice.<br />
          Postala je zelo priljubljena in skoraj ni minil dan, da si je ne bi kdo sposodil.<br />
          Vse ostale pravljice so zato postale ljubosumne. Tudi one so želele, da jih kdo prebira, zato so se poskušale na različne načine olepšati.<br />
          Nekatere so podaljšale besede.<br />
          <br />
          Nekatere so svoje slike naredile bolj pisane.<br />
          Nekatere so se odebelile.<br />
          Nekatere so se stanjšale.<br />
          Nekatere so dobile lepe nove naslovnice.<br />
          Sedaj je bilo na polici v knjižnici veliko prav posebnih pravljic. Otrokom je bilo to všeč in vse so radi brali. Pravljica, ki se ni začela z nekoč je, ni bila več sama na polici.<br />
          Izmed vseh pravljic le ena ni spremenila videza. Ostalim se je zdela čudna, zato so se do nje obnašale čudno in niso želele sloneti na polici skupaj z njo.<br />
          Tako je imela v knjižnici polico samo zase.<br />
          Ko je v knjižnico prišla neka deklica, jo je takoj opazila in jo vzela domov.<br />
          Doma na postelji jo je odprla in začela brati: “Nekoč je ...”.<br />
          <br />
          Nauk zgodbe: Nekoč je nekdo označil neko vsebino z izbrano oznako. Nato je nekdo zbrisal to vsebino in vsebina je rekla “aaa”. Tako je ostala zgolj oznaka spaka prazna sraka, brez odgovarjajoče vsebine.<br /></p>
      </div>

      <tal:block tal:condition="python: view.is_text_view() and articles['all'] or articles_num == 0">

        <h2 i18n:translate="">Articles</h2>

        <span id="results-num">
          <tal:block tal:content="articles_num">num</tal:block>
          <tal:block i18n:translate="">results</tal:block>
        </span>

        <div class="articles-intersection"
             tal:define="show_intersection view/show_intersection">
          <h3 i18n:translate=""
              tal:condition="python: show_intersection and view.tags_selected()">Intersection</h3>
          <tal:block repeat="article python: articles['intersection']">
            <tal:block tal:define="isArticle python: article.portal_type == 'tribuna.content.article';
                                   isComment python: article.portal_type == 'Discussion Item';
                                   isImage python: article.portal_type == 'tribuna.content.image';
                                   isAnnotation python: article.portal_type == 'tribuna.annotator.annotation';
                                   typeClassAddition python: (isArticle and 'article') or (isComment and 'comment') or (isImage and 'image') or (isAnnotation and 'annotation');
                                   varUID python: isComment and article.getId() or article.UID();
                                   padding python: 'left-padding' if (show_intersection and view.tags_selected()) else ''" >
              <div id="${varUID}"
                   class="ui-widget-content text-view text-view-${typeClassAddition}${hasOneTagClassAddition} ${padding}">
                <div id="gallery-link">
                  <a tal:condition="isArticle"
                     class="article-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="article/title" />
                  <a tal:condition="isImage"
                     class="article-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}">
                     <img tal:attributes="src string:${article/absolute_url}/@@images/image;
                                          alt article/title"/>
                  </a>
                  <a tal:condition="isComment"
                     class="comment-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="structure python: view.shorten_text(article.text)" />
                  <a tal:condition="isAnnotation"
                     class="annotation-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="structure python: view.shorten_text(article.quote)" />
                </div>
                <p class="article-body" tal:condition="isArticle">
                  <a tal:content="article/description"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"></a>
                </p>
                <p tal:condition="isArticle" class="content-type">
                  <span class="red" i18n:translate="">article</span>
                </p>
                <p tal:condition="isComment" class="content-type">
                  <span class="red" i18n:translate="">comment</span>
                </p>
                <p tal:condition="isImage" class="content-type">
                  <span class="red" i18n:translate="">image</span>
                </p>
                <p tal:condition="isAnnotation" class="content-type">
                  <span class="red" i18n:translate="">annotation</span>
                </p>
              </div>
            </tal:block>
          </tal:block>
        </div>

        <div class="articles-union"
             tal:define="show_union view/show_union">
          <h3 i18n:translate="" tal:condition="python: show_union and view.tags_selected()">Union</h3>
          <tal:block repeat="article python: articles['union']">
            <tal:block tal:define="isArticle python: article.portal_type == 'tribuna.content.article';
                                   isComment python: article.portal_type == 'Discussion Item';
                                   isImage python: article.portal_type == 'tribuna.content.image';
                                   isAnnotation python: article.portal_type == 'tribuna.annotator.annotation';
                                   typeClassAddition python: (isArticle and 'article') or (isComment and 'comment') or (isImage and 'image') or (isAnnotation and 'annotation');
                                   varUID python: isComment and article.getId() or article.UID();
                                   padding python: 'left-padding' if (show_union and view.tags_selected()) else '' " >
              <div id="${varUID}"
                   class="ui-widget-content text-view text-view-${typeClassAddition}${hasOneTagClassAddition} ${padding}">
                <div id="gallery-link">
                  <a tal:condition="isArticle"
                     class="article-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="article/title" />
                  <a tal:condition="isImage"
                     class="article-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}">
                     <img tal:attributes="src string:${article/absolute_url}/@@images/image;
                                          alt article/title" />
                  </a>
                  <a tal:condition="isComment"
                     class="comment-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="structure python: view.shorten_text(article.text)" />
                  <a tal:condition="isAnnotation"
                     class="annotation-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="structure python: view.shorten_text(article.quote)" />
                </div>
                <p class="article-body" tal:condition="isArticle">
                  <a tal:content="article/description"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"></a>
                </p>
                <p tal:condition="isArticle" class="content-type">
                  <span class="red" i18n:translate="">article</span>
                </p>
                <p tal:condition="isComment" class="content-type">
                  <span class="red" i18n:translate="">comment</span>
                </p>
                 <p tal:condition="isImage" class="content-type">
                  <span class="red" i18n:translate="">image</span>
                </p>
                <p tal:condition="isAnnotation" class="content-type">
                  <span class="red" i18n:translate="">annotation</span>
                </p>
              </div>
            </tal:block>
          </tal:block>
        </div>
      </tal:block>

      <tal:block tal:condition="python: not view.is_text_view()">
        <tal:block repeat="article python: articles['all']">
          <tal:block tal:define="isArticle python: article.portal_type == 'tribuna.content.article';
                                 isComment python: article.portal_type == 'Discussion Item';
                                 isImage python: article.portal_type == 'tribuna.content.image';
                                 isAnnotation python: article.portal_type == 'tribuna.annotator.annotation';
                                 typeClassAddition python: (isArticle and 'article') or (isComment and 'comment') or (isImage and 'image') or (isAnnotation and 'annotation');
                                 articleWithImage python: (isArticle and not article.image) and 'article-no-image' or '';
                                 varUID python: isComment and article.getId() or article.UID()">
            <div id="${varUID}" class="ui-widget-content drag-view-${typeClassAddition} ${articleWithImage}">
              <img tal:condition="isArticle"
                   tal:attributes="src string:${article/absolute_url}/@@images/image;
                                   alt article/title" />
              <img tal:condition="isImage"
                   tal:attributes="src string:${article/absolute_url}/@@images/image;
                                   alt article/title" />
              <div id="text">
                <div id="gallery-link">
                  <a tal:condition="python: isArticle and article.article_author"
                     class="article-author"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="article/article_author" />
                  <br tal:condition="python: isArticle and article.article_author">
                  <br tal:condition="python: isArticle and article.article_author">
                  <a tal:condition="isArticle"
                     class="article-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="article/title" />
                  <br tal:condition="isArticle">
                  <a tal:condition="python: isArticle and article.subtitle"
                     class="article-subtitle"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="article/subtitle" />

                  <a tal:condition="isImage"
                     class="image-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="article/title" />
                  <a tal:condition="isComment"
                     class="drag-comment-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="structure python: view.shorten_text(article.text)" />
                  <a tal:condition="isAnnotation"
                     class="drag-annotation-header"
                     href="${context/absolute_url}/articles/${article/id}${view/getArgs}"
                     tal:content="structure python: view.shorten_text(article.quote)" />
                </div>
                <div id="drag-view-type">
                  <p tal:condition="isArticle" class="content-type">
                    <span class="red" i18n:translate="">article</span>
                  </p>
                  <div tal:condition="isComment" id="drag-comment-info">
                    <span tal:define="creator article/Creator;
                                 mtool article/@@plone_tools/membership;
                                 author python:mtool.getMemberInfo(creator)"
                           tal:content="python:author and author['fullname'] or creator">
                      Author name
                    </span>
                    <span tal:define="DateTime python:modules['DateTime'].DateTime;"
                          tal:replace="python:article.toLocalizedTime(article.modification_date)" />
                  </div>
                  <p tal:condition="isComment" class="content-type">
                    <span class="red" i18n:translate="">comment</span>
                  </p>
                  <div tal:condition="isAnnotation" id="drag-annotation-info">
                    <span tal:define="creator article/Creator;
                                 mtool article/@@plone_tools/membership;
                                 author python:mtool.getMemberInfo(creator)"
                           tal:content="python:author and author['fullname'] or creator">
                      Author name
                    </span>
                    <span tal:define="DateTime python:modules['DateTime'].DateTime;"
                          tal:replace="python:article.toLocalizedTime(article.modification_date)" />
                  </div>
                  <p tal:condition="isAnnotation" class="content-type">
                    <span class="red" i18n:translate="">annotation</span>
                  </p>
                  <p tal:condition="isImage" class="content-type">
                  <span class="red" i18n:translate="">image</span>
                </p>
                </div>
                <div id="drag-view-tags">
                  <span id="drag-view-tags-list">
                    <tal:block tal:condition="python: isArticle or isImage">
                      <tal:block tal:define="varTagList python: ', '.join(article.Subject())">${varTagList}</tal:block>
                    </tal:block>
                  </span>
                </div>
                <p tal:condition="isArticle" class="article-body" tal:content="article/description" />

              </div>
            </div>
          </tal:block>
        </tal:block>
      </tal:block>
      </div>
    </tal:block>
    <div tal:replace="structure provider:plone.belowcontentbody" />
  </tal:main-macro>
</metal:main>

</body>
</html>
